(this["webpackJsonpreact-three-demo"]=this["webpackJsonpreact-three-demo"]||[]).push([[0],{14:function(t,e,i){t.exports=i(20)},20:function(t,e,i){"use strict";i.r(e);var o=i(9),s=i.n(o),n=i(12),r=i.n(n),a=i(5),l=i(13),c=i(0),h=i(1),d=i(10),p=i(7),u=i(2),v=i(3),m=function(t){Object(u.a)(i,t);var e=Object(v.a)(i);function i(t){var o;if(Object(c.a)(this,i),o=e.call(this),void 0===t)return console.error("ControllerGestures must be passed a renderer"),Object(d.a)(o);var s=new a.a;o.controller1=t.xr.getController(0),o.controller1.userData.gestures={index:0},o.controller1.userData.selectPressed=!1,o.controller1.addEventListener("selectstart",r),o.controller1.addEventListener("selectend",l),o.controller2=t.xr.getController(1),o.controller2.userData.gestures={index:1},o.controller2.userData.selectPressed=!1,o.controller2.addEventListener("selectstart",r),o.controller2.addEventListener("selectend",l),o.doubleClickLimit=.2,o.pressMinimum=.4,o.right=new a.m(1,0,0),o.up=new a.m(0,1,0),o.type="unknown",o.touchCount=0,o.clock=s;var n=Object(p.a)(o);function r(){var t=this.userData.gestures;t.startPosition=void 0,t.startTime=s.getElapsedTime(),-1==n.type.indexOf("tap")&&(t.taps=0),n.type="unknown",this.userData.selectPressed=!0,n.touchCount++,console.log("onSelectStart touchCount: ".concat(n.touchCount))}function l(){var t=this.userData.gestures;t.endTime=s.getElapsedTime();var e=t.endTime-t.startTime;if("swipe"===n.type){var i=n.controller1.position.y<t.startPosition.y?"DOWN":"UP";n.dispatchEvent({type:"swipe",direction:i}),n.type="unknown"}else"pinch"!==n.type&&"rotate"!==n.type&&"pan"!==n.type?e<n.doubleClickLimit?(n.type="tap",t.taps++):e>n.pressMinimum&&(n.dispatchEvent({type:"press",position:n.controller1.position,matrixWorld:n.controller1.matrixWorld}),n.type="unknown"):n.type="unknown";this.userData.selectPressed=!1,t.startPosition=void 0,n.touchCount--}return o}return Object(h.a)(i,[{key:"update",value:function(){var t=this.controller1.userData.gestures,e=this.controller2.userData.gestures,i=this.clock.getElapsedTime();if(this.controller1.userData.selectPressed&&void 0===t.startPosition&&i-t.startTime>.05&&(t.startPosition=this.controller1.position.clone()),this.controller2.userData.selectPressed&&void 0===e.startPosition&&i-e.startTime>.05&&(e.startPosition=this.controller2.position.clone()),!this.controller1.userData.selectPressed&&"tap"===this.type&&this.clock.getElapsedTime()-t.endTime>this.doubleClickLimit){switch(t.taps){case 1:this.dispatchEvent({type:"tap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 2:this.dispatchEvent({type:"doubletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 3:this.dispatchEvent({type:"tripletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 4:this.dispatchEvent({type:"quadtap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld})}this.type="unknown",t.taps=0}if("unknown"===this.type&&this.touch){if(void 0!==t.startPosition)if(this.multiTouch){if(void 0!==e.startPosition){var o=t.startPosition.distanceTo(e.startPosition),s=this.controller1.position.distanceTo(this.controller2.position)-o;if(Math.abs(s)>.01)this.type="pinch",this.startDistance=this.controller1.position.distanceTo(this.controller2.position),this.dispatchEvent({type:"pinch",delta:0,scale:1,initialise:!0});else{var n=e.startPosition.clone().sub(t.startPosition).normalize(),r=this.controller2.position.clone().sub(this.controller1.position).normalize(),l=n.angleTo(r);Math.abs(l)>.2&&(this.type="rotate",this.startVector=r.clone(),this.dispatchEvent({type:"rotate",theta:0,initialise:!0}))}}}else{var c=t.startPosition.distanceTo(this.controller1.position),h=c/(this.clock.getElapsedTime()-t.startTime);if(c>.01&&h>.1){var d=this.controller1.position.clone().sub(t.startPosition);Math.abs(d.y)>Math.abs(d.x)&&Math.abs(d.y)>Math.abs(d.z)&&(this.type="swipe")}else c>.006&&h<.03&&(this.type="pan",this.startPosition=this.controller1.position.clone(),this.dispatchEvent({type:"pan",delta:new a.m,initialise:!0}))}}else if("pinch"===this.type){var p=this.controller1.position.distanceTo(this.controller2.position),u=p-this.startDistance,v=p/this.startDistance;this.dispatchEvent({type:"pinch",delta:u,scale:v})}else if("rotate"===this.type){var m=this.controller2.position.clone().sub(this.controller1.position).normalize(),w=this.startVector.angleTo(m),y=this.startVector.clone().cross(m);this.up.dot(y)>0&&(w=-w),this.dispatchEvent({type:"rotate",theta:w})}else if("pan"===this.type){var b=this.controller1.position.clone().sub(this.startPosition);this.dispatchEvent({type:"pan",delta:b})}}},{key:"multiTouch",get:function(){var t;t=void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed&&this.controller2.userData.selectPressed);return console.log("ControllerGestures multiTouch: ".concat(t," touchCount:").concat(this.touchCount)),t}},{key:"touch",get:function(){return void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed||this.controller2.userData.selectPressed)}},{key:"debugMsg",get:function(){return this.type}}]),i}(a.c);function w(){return Object(o.useEffect)((function(){var t,e,i,o,s,n,r;function c(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function h(t,s){o.render(i,e)}!function(){t=document.querySelector(".scene"),i=new a.j;var h=(new a.k).load("./textures/silhouette.png");e=new a.g(70,window.innerWidth/window.innerHeight,.01,20);var d=new a.d(16777215,12303359,1);d.position.set(.5,1,.25),i.add(d),(o=new a.n({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,t.appendChild(o.domElement);var p=new m(o);n=new a.i,console.log("camera.position",e.position);e.position;r=new a.l;p.addEventListener("tap",(function(t){console.log("tap"),r.x=t.clientX/window.innerWidth*2-1,r.y=-t.clientY/window.innerHeight*2+1,console.log(r.x,r.y)}));var u=new a.e(new a.h(100,100,1,1),new a.f({side:a.b,transparent:!0,opacity:0}));u.rotation.x=Math.PI/2,u.position.set(0,-1.4,-2),i.add(u),document.body.appendChild(l.a.createButton(o,{requiredFeatures:["hit-test"]}));var v=new a.h(.7,2,1),w=new a.f({transparent:!0,side:a.b,map:h}),y=new a.e(v,w);i.add(y),y.visible=!1,(s=o.xr.getController(0)).addEventListener("select",(function(){n.setFromCamera(r,e);var t=n.intersectObjects(i.children,!1)[0].point;console.log(t),y.visible?y.visible&&y.position.set(t.x,t.y+1,t.z):(y.position.set(t.x,t.y+1,t.z),y.visible=!0)})),i.add(s),window.addEventListener("resize",c)}(),o.setAnimationLoop(h)}),[]),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"scene"}))}var y=document.getElementById("root");r.a.render(s.a.createElement(w,null),y)}},[[14,1,2]]]);
//# sourceMappingURL=main.5f2f831d.chunk.js.map