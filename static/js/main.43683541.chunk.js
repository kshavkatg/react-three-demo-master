(this["webpackJsonpreact-three-demo"]=this["webpackJsonpreact-three-demo"]||[]).push([[0],{10:function(t,e,o){"use strict";o.r(e);var i=o(1),n=o.n(i),s=o(3),r=o.n(s),l=o(0);class a extends l.c{constructor(t){if(super(),void 0===t)return void console.error("ControllerGestures must be passed a renderer");const e=new l.a;this.controller1=t.xr.getController(0),this.controller1.userData.gestures={index:0},this.controller1.userData.selectPressed=!1,this.controller1.addEventListener("selectstart",i),this.controller1.addEventListener("selectend",n),this.controller2=t.xr.getController(1),this.controller2.userData.gestures={index:1},this.controller2.userData.selectPressed=!1,this.controller2.addEventListener("selectstart",i),this.controller2.addEventListener("selectend",n),this.doubleClickLimit=.2,this.pressMinimum=.4,this.right=new l.o(1,0,0),this.up=new l.o(0,1,0),this.type="unknown",this.touchCount=0,this.clock=e;const o=this;function i(){const t=this.userData.gestures;t.startPosition=void 0,t.startTime=e.getElapsedTime(),-1==o.type.indexOf("tap")&&(t.taps=0),o.type="unknown",this.userData.selectPressed=!0,o.touchCount++,console.log("onSelectStart touchCount: ".concat(o.touchCount))}function n(){const t=this.userData.gestures;t.endTime=e.getElapsedTime();const i=t.endTime-t.startTime;if("swipe"===o.type){const e=o.controller1.position.y<t.startPosition.y?"DOWN":"UP";o.dispatchEvent({type:"swipe",direction:e}),o.type="unknown"}else"pinch"!==o.type&&"rotate"!==o.type&&"pan"!==o.type?i<o.doubleClickLimit?(o.type="tap",t.taps++):i>o.pressMinimum&&(o.dispatchEvent({type:"press",position:o.controller1.position,matrixWorld:o.controller1.matrixWorld}),o.type="unknown"):o.type="unknown";this.userData.selectPressed=!1,t.startPosition=void 0,o.touchCount--}}get multiTouch(){let t;t=void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed&&this.controller2.userData.selectPressed);return console.log("ControllerGestures multiTouch: ".concat(t," touchCount:").concat(this.touchCount)),t}get touch(){let t;return t=void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed||this.controller2.userData.selectPressed),t}get debugMsg(){return this.type}update(){const t=this.controller1.userData.gestures,e=this.controller2.userData.gestures,o=this.clock.getElapsedTime();let i;if(this.controller1.userData.selectPressed&&void 0===t.startPosition&&(i=o-t.startTime,i>.05&&(t.startPosition=this.controller1.position.clone())),this.controller2.userData.selectPressed&&void 0===e.startPosition&&(i=o-e.startTime,i>.05&&(e.startPosition=this.controller2.position.clone())),!this.controller1.userData.selectPressed&&"tap"===this.type&&(i=this.clock.getElapsedTime()-t.endTime,i>this.doubleClickLimit)){switch(t.taps){case 1:this.dispatchEvent({type:"tap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 2:this.dispatchEvent({type:"doubletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 3:this.dispatchEvent({type:"tripletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 4:this.dispatchEvent({type:"quadtap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld})}this.type="unknown",t.taps=0}if("unknown"===this.type&&this.touch){if(void 0!==t.startPosition)if(this.multiTouch){if(void 0!==e.startPosition){const o=t.startPosition.distanceTo(e.startPosition),i=this.controller1.position.distanceTo(this.controller2.position)-o;if(Math.abs(i)>.01)this.type="pinch",this.startDistance=this.controller1.position.distanceTo(this.controller2.position),this.dispatchEvent({type:"pinch",delta:0,scale:1,initialise:!0});else{const o=e.startPosition.clone().sub(t.startPosition).normalize(),i=this.controller2.position.clone().sub(this.controller1.position).normalize(),n=o.angleTo(i);Math.abs(n)>.2&&(this.type="rotate",this.startVector=i.clone(),this.dispatchEvent({type:"rotate",theta:0,initialise:!0}))}}}else{let e=t.startPosition.distanceTo(this.controller1.position);i=this.clock.getElapsedTime()-t.startTime;const o=e/i;if(e>.01&&o>.1){const e=this.controller1.position.clone().sub(t.startPosition);Math.abs(e.y)>Math.abs(e.x)&&Math.abs(e.y)>Math.abs(e.z)&&(this.type="swipe")}else e>.006&&o<.03&&(this.type="pan",this.startPosition=this.controller1.position.clone(),this.dispatchEvent({type:"pan",delta:new l.o,initialise:!0}))}}else if("pinch"===this.type){const t=this.controller1.position.distanceTo(this.controller2.position),e=t-this.startDistance,o=t/this.startDistance;this.dispatchEvent({type:"pinch",delta:e,scale:o})}else if("rotate"===this.type){const t=this.controller2.position.clone().sub(this.controller1.position).normalize();let e=this.startVector.angleTo(t);const o=this.startVector.clone().cross(t);this.up.dot(o)>0&&(e=-e),this.dispatchEvent({type:"rotate",theta:e})}else if("pan"===this.type){const t=this.controller1.position.clone().sub(this.startPosition);this.dispatchEvent({type:"pan",delta:t})}}}function c(t){let{onStartClick:e}=t;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"start_view"},n.a.createElement("img",{className:"start_view_heart",src:"./images/white_heart.png",alt:"logo"})))}function d(){return Object(i.useEffect)(()=>{let t,e,o,i,n,s,r;function c(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)}function d(t,n){i.render(o,e)}!function(){t=document.querySelector(".scene"),o=new l.k;const d=(new l.m).load("./textures/silhouette.png");e=new l.h(70,window.innerWidth/window.innerHeight,.01,20);const h=new l.d(16777215,12303359,1);h.position.set(.5,1,.25),o.add(h),i=new l.q({antialias:!0,alpha:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.xr.enabled=!0,t.appendChild(i.domElement);const p=new a(i);s=new l.j;e.position;r=new l.n;p.addEventListener("tap",t=>{console.log("tap"),r.x=t.clientX/window.innerWidth*2-1,r.y=-t.clientY/window.innerHeight*2+1,console.log(r.x,r.y)});const u=new l.f(new l.i(100,100,1,1),new l.g({side:l.b,transparent:!0,opacity:0}));u.name="ground",u.rotation.x=Math.PI/2,u.position.set(0,-.5,0),o.add(u),document.body.appendChild(class{static createButton(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=document.createElement("button");function i(){o.style.display="",o.style.cursor="auto",o.onmouseenter=null,o.onmouseleave=null,o.onclick=null,o.textContent="AR NOT SUPPORTED"}function n(t){t.style.position="absolute",t.style.bottom="18%",t.style.width="75%",t.style.height="90px",t.style.zIndex="999",t.style.background="black",t.style.backgroundImage='url("./images/start_button.png")',t.style.backgroundSize="cover"}if("xr"in navigator)return o.id="ARButton",o.style.display="none",n(o),navigator.xr.isSessionSupported("immersive-ar").then((function(n){n?function(){if(void 0===e.domOverlay){var i=document.createElement("div");i.style.display="none",document.body.appendChild(i);var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("width",38),n.setAttribute("height",38),n.style.position="absolute",n.style.right="20px",n.style.top="20px",n.addEventListener("click",(function(){r.end()})),i.appendChild(n);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d","M 12,12 L 28,28 M 28,12 12,28"),s.setAttribute("stroke","#fff"),s.setAttribute("stroke-width",2),n.appendChild(s),void 0===e.optionalFeatures&&(e.optionalFeatures=[]),e.optionalFeatures.push("dom-overlay"),e.domOverlay={root:i}}let r=null;async function l(i){i.addEventListener("end",a),t.xr.setReferenceSpaceType("local"),await t.xr.setSession(i),o.textContent="STOP AR",e.domOverlay.root.style.display="",r=i}function a(){r.removeEventListener("end",a),o.textContent="",e.domOverlay.root.style.display="none",r=null}o.style.display="",o.style.cursor="pointer",o.textContent="",o.onmouseenter=function(){},o.onmouseleave=function(){},o.onclick=function(){null===r?navigator.xr.requestSession("immersive-ar",e).then(l):r.end()}}():i()})).catch(i),o;{const t=document.createElement("a");return!1===window.isSecureContext?(t.href=document.location.href.replace(/^http:/,"https:"),t.innerHTML="WEBXR NEEDS HTTPS"):(t.href="https://immersiveweb.dev/",t.innerHTML="WEBXR NOT AVAILABLE"),t.style.left="calc(50% - 90px)",t.style.width="180px",t.style.textDecoration="none",n(t),t}}}.createButton(i,{requiredFeatures:["hit-test"]}));const m=new l.i(1.4,4,1),v=(new l.g({transparent:!0,side:l.b,map:d}),document.getElementById("greenscreenvideo")),y=["varying vec2 vUv;","void main(void)","{","vUv = uv;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),w=["uniform sampler2D myTexture;","uniform vec3 color;","varying vec2 vUv;","void main(void)","{","vec3 tColor = texture2D( myTexture, vUv ).rgb;","float a = (length(tColor - color) - 0.5) * 7.0;","gl_FragColor = vec4(tColor, a);","}"].join("\n"),g=(new l.i(3,4,1),new l.p(v));g.minFilter=l.e;const f=new l.l({uniforms:{color:{type:"c",value:{x:.1,y:.9,z:.2}},myTexture:{type:"t",value:g}},vertexShader:y,fragmentShader:w}),x=new l.f(m,f);o.add(x),x.visible=!1,n=i.xr.getController(0),n.addEventListener("select",(function(){s.setFromCamera(r,e);const t=s.intersectObjects(o.children,!1);let i;v.play(),t.forEach(t=>{"ground"===t.object.name&&(i=t.point)}),console.log(i),x.visible?x.visible&&x.position.set(i.x,i.y,i.z):(x.position.set(i.x,i.y,i.z),x.visible=!0)})),o.add(n),window.addEventListener("resize",c)}(),i.setAnimationLoop(d)},[]),n.a.createElement(n.a.Fragment,null,n.a.createElement("video",{id:"greenscreenvideo",playsinline:!0,preload:"auto",src:"./video/Tina_Trinity_original_big.mp4","response-type":"arraybuffer",style:{opacity:0}}),n.a.createElement(c,null),n.a.createElement("div",{className:"scene"}))}o(9);const h=document.getElementById("root");r.a.render(n.a.createElement(d,null),h)},4:function(t,e,o){t.exports=o(10)},9:function(t,e,o){}},[[4,1,2]]]);
//# sourceMappingURL=main.43683541.chunk.js.map