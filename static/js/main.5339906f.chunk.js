(this["webpackJsonpreact-three-demo"]=this["webpackJsonpreact-three-demo"]||[]).push([[0],{10:function(t,e,s){"use strict";s.r(e);var i=s(1),o=s.n(i),n=s(3),r=s.n(n),l=s(0);class a extends l.c{constructor(t){if(super(),void 0===t)return void console.error("ControllerGestures must be passed a renderer");const e=new l.a;this.controller1=t.xr.getController(0),this.controller1.userData.gestures={index:0},this.controller1.userData.selectPressed=!1,this.controller1.addEventListener("selectstart",i),this.controller1.addEventListener("selectend",o),this.controller2=t.xr.getController(1),this.controller2.userData.gestures={index:1},this.controller2.userData.selectPressed=!1,this.controller2.addEventListener("selectstart",i),this.controller2.addEventListener("selectend",o),this.doubleClickLimit=.2,this.pressMinimum=.4,this.right=new l.m(1,0,0),this.up=new l.m(0,1,0),this.type="unknown",this.touchCount=0,this.clock=e;const s=this;function i(){const t=this.userData.gestures;t.startPosition=void 0,t.startTime=e.getElapsedTime(),-1==s.type.indexOf("tap")&&(t.taps=0),s.type="unknown",this.userData.selectPressed=!0,s.touchCount++,console.log("onSelectStart touchCount: ".concat(s.touchCount))}function o(){const t=this.userData.gestures;t.endTime=e.getElapsedTime();const i=t.endTime-t.startTime;if("swipe"===s.type){const e=s.controller1.position.y<t.startPosition.y?"DOWN":"UP";s.dispatchEvent({type:"swipe",direction:e}),s.type="unknown"}else"pinch"!==s.type&&"rotate"!==s.type&&"pan"!==s.type?i<s.doubleClickLimit?(s.type="tap",t.taps++):i>s.pressMinimum&&(s.dispatchEvent({type:"press",position:s.controller1.position,matrixWorld:s.controller1.matrixWorld}),s.type="unknown"):s.type="unknown";this.userData.selectPressed=!1,t.startPosition=void 0,s.touchCount--}}get multiTouch(){let t;t=void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed&&this.controller2.userData.selectPressed);return console.log("ControllerGestures multiTouch: ".concat(t," touchCount:").concat(this.touchCount)),t}get touch(){let t;return t=void 0!==this.controller1&&void 0!==this.controller2&&(this.controller1.userData.selectPressed||this.controller2.userData.selectPressed),t}get debugMsg(){return this.type}update(){const t=this.controller1.userData.gestures,e=this.controller2.userData.gestures,s=this.clock.getElapsedTime();let i;if(this.controller1.userData.selectPressed&&void 0===t.startPosition&&(i=s-t.startTime,i>.05&&(t.startPosition=this.controller1.position.clone())),this.controller2.userData.selectPressed&&void 0===e.startPosition&&(i=s-e.startTime,i>.05&&(e.startPosition=this.controller2.position.clone())),!this.controller1.userData.selectPressed&&"tap"===this.type&&(i=this.clock.getElapsedTime()-t.endTime,i>this.doubleClickLimit)){switch(t.taps){case 1:this.dispatchEvent({type:"tap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 2:this.dispatchEvent({type:"doubletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 3:this.dispatchEvent({type:"tripletap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld});break;case 4:this.dispatchEvent({type:"quadtap",position:this.controller1.position,matrixWorld:this.controller1.matrixWorld})}this.type="unknown",t.taps=0}if("unknown"===this.type&&this.touch){if(void 0!==t.startPosition)if(this.multiTouch){if(void 0!==e.startPosition){const s=t.startPosition.distanceTo(e.startPosition),i=this.controller1.position.distanceTo(this.controller2.position)-s;if(Math.abs(i)>.01)this.type="pinch",this.startDistance=this.controller1.position.distanceTo(this.controller2.position),this.dispatchEvent({type:"pinch",delta:0,scale:1,initialise:!0});else{const s=e.startPosition.clone().sub(t.startPosition).normalize(),i=this.controller2.position.clone().sub(this.controller1.position).normalize(),o=s.angleTo(i);Math.abs(o)>.2&&(this.type="rotate",this.startVector=i.clone(),this.dispatchEvent({type:"rotate",theta:0,initialise:!0}))}}}else{let e=t.startPosition.distanceTo(this.controller1.position);i=this.clock.getElapsedTime()-t.startTime;const s=e/i;if(e>.01&&s>.1){const e=this.controller1.position.clone().sub(t.startPosition);Math.abs(e.y)>Math.abs(e.x)&&Math.abs(e.y)>Math.abs(e.z)&&(this.type="swipe")}else e>.006&&s<.03&&(this.type="pan",this.startPosition=this.controller1.position.clone(),this.dispatchEvent({type:"pan",delta:new l.m,initialise:!0}))}}else if("pinch"===this.type){const t=this.controller1.position.distanceTo(this.controller2.position),e=t-this.startDistance,s=t/this.startDistance;this.dispatchEvent({type:"pinch",delta:e,scale:s})}else if("rotate"===this.type){const t=this.controller2.position.clone().sub(this.controller1.position).normalize();let e=this.startVector.angleTo(t);const s=this.startVector.clone().cross(t);this.up.dot(s)>0&&(e=-e),this.dispatchEvent({type:"rotate",theta:e})}else if("pan"===this.type){const t=this.controller1.position.clone().sub(this.startPosition);this.dispatchEvent({type:"pan",delta:t})}}}function c(t){let{onStartClick:e}=t;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"start_view"},o.a.createElement("img",{className:"start_view_heart",src:"./images/white_heart.png",alt:"logo"})))}function h(){return Object(i.useEffect)(()=>{let t,e,s,i,o,n,r;function c(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)}function h(t,o){i.render(s,e)}!function(){t=document.querySelector(".scene"),s=new l.j;const h=(new l.k).load("./textures/silhouette.png");e=new l.g(70,window.innerWidth/window.innerHeight,.01,20);const p=new l.d(16777215,12303359,1);p.position.set(.5,1,.25),s.add(p),i=new l.n({antialias:!0,alpha:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.xr.enabled=!0,t.appendChild(i.domElement);const u=new a(i);n=new l.i,console.log("camera.position",e.position);e.position;r=new l.l;u.addEventListener("tap",t=>{console.log("tap"),r.x=t.clientX/window.innerWidth*2-1,r.y=-t.clientY/window.innerHeight*2+1,console.log(r.x,r.y)});const m=new l.e(new l.h(100,100,1,1),new l.f({side:l.b,transparent:!0,opacity:0}));m.rotation.x=Math.PI/2,m.position.set(0,-1.4,-2),s.add(m),document.body.appendChild(d.createButton(i,{requiredFeatures:["hit-test"]}));const w=new l.h(.7,2,1),y=new l.f({transparent:!0,side:l.b,map:h}),g=new l.e(w,y);s.add(g),g.visible=!1,o=i.xr.getController(0),o.addEventListener("select",(function(){n.setFromCamera(r,e);const t=n.intersectObjects(s.children,!1)[0].point;console.log(t),g.visible?g.visible&&g.position.set(t.x,t.y+1,t.z):(g.position.set(t.x,t.y+1,t.z),g.visible=!0)})),s.add(o),window.addEventListener("resize",c)}(),i.setAnimationLoop(h);const d=document.getElementById("ARButton");d.style={},d.backgroundImage='url("./images/start_button.png")'},[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(c,null),o.a.createElement("div",{className:"scene"}))}s(9);const d=document.getElementById("root");r.a.render(o.a.createElement(h,null),d)},4:function(t,e,s){t.exports=s(10)},9:function(t,e,s){}},[[4,1,2]]]);
//# sourceMappingURL=main.5339906f.chunk.js.map